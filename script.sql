CREATE DATABASE maxDB;

USE maxDB;

CREATE TABLE lavaAuto(
	id INT AUTO_INCREMENT,
	vehicleId INT,
	fecha DATETIME,
	PRIMARY KEY(id)
);

SELECT * FROM lavaAuto;

INSERT INTO `lavaAuto` VALUES (1,2441,'2019-06-10 13:27:59');
INSERT INTO `lavaAuto` VALUES (2,2415,'2019-06-10 13:28:43');
INSERT INTO `lavaAuto` VALUES (3,2407,'2019-06-10 13:28:52');
INSERT INTO `lavaAuto` VALUES (4,2415,'2019-06-10 13:30:20');
INSERT INTO `lavaAuto` VALUES (5,2415,'2019-06-10 13:33:11');
INSERT INTO `lavaAuto` VALUES (6,2406,'2019-06-10 13:33:25');
INSERT INTO `lavaAuto` VALUES (7,2418,'2019-06-10 13:33:28');
INSERT INTO `lavaAuto` VALUES (8,2410,'2019-06-10 13:33:34');
INSERT INTO `lavaAuto` VALUES (9,2426,'2019-06-10 13:33:37');
INSERT INTO `lavaAuto` VALUES (10,2418,'2019-06-10 13:33:42');
INSERT INTO `lavaAuto` VALUES (11,2418,'2019-06-10 14:24:28');

SELECT 
    vehicleId AS 'vehicle',
(
    SELECT MAX(fecha)
    FROM lavaAuto
    WHERE vehicleId = vehicle
) AS 'Max'
FROM lavaAuto
GROUP BY vehicleId
ORDER BY Max DESC;




